<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastrar funcionarios | Point</title>
    <link rel="stylesheet" href="css/styleDashAlterFunc.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <header>
        <nav id="menu">
            <a href="maquinas.html" class="logo">
                <img src="../assets/imgs/Point.png">
            </a>
            <hr>
            <!-- <a href="alertas.html">
                <img src="../assets/imgs/alfinete 1.png">
                <span>Alertas</span>
            </a> -->
            <a href="funcionarios.html" class="img-nav">
                <img src="../assets/imgs/user.png" >
                <span>Funcionários</span>
            </a>
            <a href="maquinas.html" class="img-nav">
                <img src="./assets/imgs/imac.png">
                <span>Máquinas</span>
            </a>
            <a href="configuracoes.html" class="img-nav">
                <img src="./assets/imgs/setting.png">
                <span>Configurações</span>
            </a>
            <hr>
            <a href="../index.html" class="img-nav">
                <img src="../assets/imgs/x.png">
                <span>Sair</span>
            </a>
        </nav>
        <nav id="menu-mobile"><img src="assets/dash/bars.svg"></nav>
    </header>
    <main>
        <section class="funcionarios">
            <section class="top">
                <div class="top-meio">
                    <input style="visibility: hidden;" id="inp-pesquisar-funcionario" type="search" placeholder="Pesquise por funcionário">
                </div>
                <div class="top-dir">
                    
                    <p class="nome"><span id="nomeGerente"></span></p>
                    <img src="../assets/dash/icons8-user-64.png">
                </div>
            </section>

            <section class="under">
                <section class="cad_func">
                    
                    
                    <div class="titulo">
                        <h1>Atualizar Empresa</h1>
                    </div>

                    <div class="formulario">
                        <div class="box_cad">
                            <div class="inputs">
                                <span class="span_text">Nome atual:</span> <br />
                                <div class="atual"><span id="nome_atual"></span></div>
                            </div>

                            <div class="inputs">
                                <span class="span_text">CNPJ atual:</span> <br />
                                <div class="atual"><span id="cnpj_atual"></span></div>
                            </div>

                            <div class="inputs">
                                <span class="span_text">Plano atual:</span> <br />
                                <div class="atual"><span id="plano_atual"></span></div>
                            </div>
                            
                            <div class="inputs">
                                <span class="span_text">Quantidade Gestor:</span> <br />
                                <div class="atual"><span id="qtd_atual"></span></div>
                            </div>

                        </div>
                        <div class="linha"></div>
                        <div class="box_cad">
                            <div class="inputs">
                                <span class="span_text">Novo Nome:</span> <br />
                                <input class="input" id="newNome_input" placeholder="Insira novo nome" />
                            </div>

                            <div class="inputs">
                                <span class="span_text">Alterar plano:</span> <br/>       
                                <div class="dropdown">
                                    <div class="select">
                                      <span>Selecione o Plano</span>
                                      <i class="fa fa-chevron-left"></i>
                                    </div>
                                    <input type="hidden" name="gender">
                                    <ul class="dropdown-menu">
                                        <li id="3">Basic</li>
                                        <li id="2">Pro</li>
                                        <li id="1">Premium</li>
                                    </ul>
                                  </div>
                                  <a href="../index.html#contato"><small>Saiba mais...</small></a>
                            </div>

                            <div class="inputs">
                                <button class="custom-btn btn-8"onclick="alterar()">Adicionar Gestor</button>
                            </div>
                        </div>

                        
                    </div>
                    <div class="inputs" style="margin-top: 2%;">
                        <span class="span_text">Senha gerente:</span> <br />
                        <input class="input_senhaGerente" type="password" id="senhaGerente_input"
                            placeholder="Senha do gerente" />
                    </div>

                    <div class="botao_cadastro">
                        <button class="custom-btn btnEntrar" onclick="alterar()">
                            Salvar
                        </button>
                    </div>

                    <div class="loader">
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                            x="0px" y="0px" width="40px" height="40px" viewBox="0 0 50 50"
                            style="enable-background:new 0 0 50 50;" xml:space="preserve">
                            <path fill="#000"
                                d="M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z">
                                <animateTransform attributeType="xml" attributeName="transform" type="rotate"
                                    from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite" />
                            </path>
                        </svg>
                    </div>
              
                </section>
            </section>

        </section>
    </main>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="select-box.js"></script>

    <script>
        nomeGerente.innerHTML=sessionStorage.NOME_USUARIO;
        function cadastrar() {

        var nomeFuncVar = nome_input.value;
        var emailVar = email_input.value;
        var telVar = tel_input.value;
        var cpfVar = cpf_input.value;
        var senhaVar = senha_input.value;
        var confirmacaoSenhaVar = confirmacao_senha_input.value;

        var idEmpresa = 1;

        // if (nomeFuncVar == "" || emailVar == "" || senhaVar == "" || confirmacaoSenhaVar == "" || cpfVar == "" || telVar == "") {
        //     mostrarAlerta("Preencha todos os campos para prosseguir!");
        //     return false;
        // }
        // if (emailVar.indexOf("@") == -1) {
        //     mostrarAlerta("E-mail inválido! Verifique e tente novamente.");
        //     return false;
        // } else if (cpfVar != Number(cpfVar)) {
        //     mostrarAlerta("CPF deve conter apenas números.");
        //     return false;
        // } else if (cpfVar.length != 11) {
        //     mostrarAlerta("CPF deve conter 11 dígitos.");
        //     return false;
        // } else if (senhaVar != confirmacaoSenhaVar) {
        //     mostrarAlerta("As senhas inseridas devem ser iguais para prosseguir!");
        //     return false;
        // }else if (telVar != 11 || telVar != Number(telVar)) {
        //     mostrarAlerta("Telefone deve conter 11 digitos e apenas números.");
        //     return false;
        // }

        // alerta.style.display = "none";

        // Enviando o valor da nova input
        // fetch("/usuarios/cadastrarFuncionario", {
        //     method: "POST",
        //     headers: {
        //         "Content-Type": "application/json"
        //     },
        //     body: JSON.stringify({
        //         // crie um atributo que recebe o valor recuperado aqui
        //         // Agora vá para o arquivo routes/usuario.js
        //         nomeEmpresaServer: nomeEmpresa,
        //         cnpjServer: cnpjVar
        //     })
        // }).then(function (resposta) {

        //     console.log("resposta: ", resposta);

        //     if (resposta.ok) {

        //         resposta.json().then(json => {
        //             idEmpresa = json.insertId;
                    //fetch do gestor
                    fetch("/usuarios/cadastrarFuncionario", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            // crie um atributo que recebe o valor recuperado aqui
                            // Agora vá para o arquivo routes/usuario.js
                            nomeFuncServer: nomeFuncVar,
                            cpfServer: cpfVar,
                            emailServer: emailVar,
                            senhaServer: senhaVar,
                            telServer: telVar,
                            idEmpresaServer: idEmpresa
                        })
                    }).then(function (resposta) {

                        console.log("resposta: ", resposta);

                        if (resposta.ok) {

                            setTimeout(() => {
                                console.log("entrou")
                                window.location = "funcionarios.html";
                            }, 1000)

                            limparFormulario();

                        } else {
                            alert("Não foi possível realizar o login")
                            throw ("Houve um erro ao tentar realizar o cadastro!");
                        }
                    }).catch(function (resposta) {
                        console.log(`#ERRO: ${resposta}`);

                    });
                // });



    //         } else {
    //             alert("Não foi possível realizar o login")
    //             throw ("Houve um erro ao tentar realizar o cadastro!");
    //         }
    //     }).catch(function (resposta) {
    //         console.log(`#ERRO: ${resposta}`);

    //     });

    //     return false;
    }
    </script>
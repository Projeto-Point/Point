<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Tempo Real | Point</title>
    <link rel="stylesheet" href="css/styleDash.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Advent+Pro:wght@100;200;300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <header>
        <nav id="menu">
            <a href="index.html" class="logo">
                <img src="assets/imgs/Point.png">
            </a>
            <hr>
            <a href="#">
                <img src="assets/imgs/alfinete 1.png">
                <span>Dashboard</span>
            </a>
            <a href="#">
                <img src="assets/imgs/alfinete 1.png">
                <span>Alertas</span>
            </a>
            <a href="#">
                <img src="assets/imgs/alfinete 1.png">
                <span>Funcionários</span>
            </a>
            <a href="#">
                <img src="assets/imgs/alfinete 1.png">
                <span>Máquinas</span>
            </a>
        </nav>
        <nav id="menu-mobile"><img src="assets/imgs/alfinete 1.png"></nav>
    </header>
    <main>
        <section class="top">
            <div class="top-esq">
                <p class="titulo">Olá, <span id="b_usuario"></span></p>
                <p class="subtitulo">02/10/2022 - 13:56</p>
            </div>
            <div class="top-meio">
                <input id="inp-pesquisar-funcionario" type="search" placeholder="Pesquise o nome de um funcionário...">
            </div>
            <div class="top-dir">
                <button><img src="assets/dash/bell.png"></button>
                <p class="nome">Agda Taniguchi</p>
                <img src="assets/dash/pessoa.jpeg">
            </div>
        </section>
        <section class="dashboard">
            <div class="grafico" id="gfCpu">
                <h3>Processador</h3>
                <div> <canvas id="myChart" style="position: relative;"></canvas></div>
            </div>
            <div class="grafico" id="gfDisco">
                <h3>Disco</h3>
                <div><canvas id="myChart2" style="position: relative; width: 20vh"></canvas></div>
            </div>
            <div class="grafico" id="gfRam">
                <h3>Memória RAM</h3>
                <div>
                    <div><canvas id="myChart3" style="position: relative;"></canvas></div>
                </div>
            </div>
            <div class="tabela" id="tbProcessos">
                <h3>Aplicativos abertos</h3>
                <table>
                    <tr>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                    </tr>
                    <tr>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                    </tr>
                </table>
            </div>
            <div class="tabela" id="tbHistorico">
                <h3>Histórico</h3>
                <table>
                    <tr>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                    </tr>
                    <tr>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                        <td>Algo</td>
                    </tr>
                </table>
            </div>
            <div class="tabela" id="tbHorario">
                <h3>Últimos alertas</h3>
            </div>
            <div class="tabela" id="tbFuncionario">
                <h3>Sobre o funcionário</h3>
                <p>Nome: <span id="nome"></span></p>
                <p>Cargo:</p>
                <p>E-mail:<span id="mail"></span></p>
            </div>
        </section>
    </main>
</body>

</html>
<script>
    var cpuMedida = [];
    var discoUtilizado = [];
    var ramMedida = [];

    function recuperarDados() {


        fetch(`/medidas/pegarRegistroCPU?idMaquina=1`).then(function (res) {
            if (res.ok) {
                res.json().then(CPU => {


                    cpuMedida = CPU.map((object) => object.valor);

                    var cpuMedida1 = Number(parseFloat(cpuMedida[0]));
                    var cpuMedida2 = Number(parseFloat(cpuMedida[1]));
                    var cpuMedida3 = Number(parseFloat(cpuMedida[2]));
                    var cpuMedida4 = Number(parseFloat(cpuMedida[3]));
                    var cpuMedida5 = Number(parseFloat(cpuMedida[4]));
                    var cpuMedida6 = Number(parseFloat(cpuMedida[5]));
                    var cpuMedida7 = Number(parseFloat(cpuMedida[6]));
                    var cpuMedida8 = Number(parseFloat(cpuMedida[7]));
                    var cpuMedida9 = Number(parseFloat(cpuMedida[8]));
                    var cpuMedida10 = Number(parseFloat(cpuMedida[9]));

                    const labels = [
                        '',
                        '',
                        '',
                        '',
                        '',
                        '',
                    ];

                    const data = {
                        labels: labels,
                        datasets: [{
                            //CPU
                            label: 'CPU',
                            data: [cpuMedida1, cpuMedida2, cpuMedida3, cpuMedida4, cpuMedida5, cpuMedida6, cpuMedida7, cpuMedida8, cpuMedida9, cpuMedida10],
                            fill: false,
                            borderColor: 'rgb(75, 192, 192)',
                            tension: 0.1
                        }]
                    };

                    const config = {
                        type: 'line',
                        data: data,
                        options: {
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    };

                    const myChart = new Chart(
                        document.getElementById('myChart'),
                        config
                    );

                })
            }
        })

        fetch(`/medidas/pegarRegistroDISCO?idMaquina=1`).then(function (res) {
            if (res.ok) {
                res.json().then(DISCO => {


                    discoUtilizado = DISCO.map((object) => object.valor);
                    discoLivre = 100 - discoUtilizado;

                    const labels2 = [
                        'Livre',
                        'Ocupado',
                    ];

                    const data2 = {
                        labels: labels2,
                        datasets: [{
                            // Armazenamento 
                            label: 'Armazenamento',
                            backgroundColor: ['rgb(255, 000, 000)', 'rgb(75, 192, 192)'],
                            borderColor: ['rgb(255, 000, 000)', 'rgb(75, 192, 192)'],
                            data: [discoUtilizado, discoLivre]
                        }
                        ]
                    };

                    const config2 = {
                        type: 'pie',
                        data: data2,
                        options: {
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            responsive: false,
                        }
                    };

                    const myChart2 = new Chart(
                        document.getElementById('myChart2'),
                        config2
                    );
                })
            }
        })

        fetch(`/medidas/pegarRegistroRAM?idMaquina=1`).then(function (res) {
            if (res.ok) {
                res.json().then(RAM => {

                    ramMedida = RAM.map((object) => object.valor);

                    var ramMedida1 = Number(parseFloat(ramMedida[0]));
                    var ramMedida2 = Number(parseFloat(ramMedida[1]));
                    var ramMedida3 = Number(parseFloat(ramMedida[2]));
                    var ramMedida4 = Number(parseFloat(ramMedida[3]));
                    var ramMedida5 = Number(parseFloat(ramMedida[4]));
                    var ramMedida6 = Number(parseFloat(ramMedida[5]));
                    var ramMedida7 = Number(parseFloat(ramMedida[6]));
                    var ramMedida8 = Number(parseFloat(ramMedida[7]));
                    var ramMedida9 = Number(parseFloat(ramMedida[8]));
                    var ramMedida10 = Number(parseFloat(ramMedida[9]));

                    const labels3 = [
                        '',
                        '',
                        '',
                        '',
                        '',
                        '',
                    ];

                    const data3 = {
                        labels: labels3,
                        datasets: [{
                            //RAM
                            label: 'RAM',
                            data: [ramMedida1, ramMedida2, ramMedida3, ramMedida4, ramMedida5, ramMedida6, ramMedida7, ramMedida8, ramMedida9, ramMedida10],
                            fill: false,
                            borderColor: 'rgb(75, 192, 192)',
                            tension: 0.1
                        }]
                    };

                    const config3 = {
                        type: 'line',
                        data: data3,
                        options: {
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    };

                    const myChart3 = new Chart(
                        document.getElementById('myChart3'),
                        config3
                    );

                })
            }
        })

        fetch(`/medidas/pegarRegistroFuncionario?idMaquina=1`).then(function (res) {
            if (res.ok) {
                res.json().then(RegistroFuncionario => {
                    console.log(RegistroFuncionario)

                    var nomeFuncionario = RegistroFuncionario.map((object) => object.nome);
                    var emailFuncionario = RegistroFuncionario.map((object) => object.email);

                    nome.innerHTML = nomeFuncionario;
                    mail.innerHTML = emailFuncionario

                })
            }
        })
    }

    
    recuperarDados()
</script>